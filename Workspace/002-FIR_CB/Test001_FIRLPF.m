%
pkg load control;
pkg load signal;
clear all;
clc
close all;
% Sine wave 100Hz
fs = 5000; %5000Hz sampling frequency
f1 = 100;
t1 = (0:50)/fs;
x1 = sin(2*pi*f1*t1);
figure(1)
subplot(2,1,1)
plot(t1,x1)
[H,w] = freqz(x1);
subplot(2,1,2)
plot(w,abs(H))
%Sine wave 500Hz
fs = 5000; %5000Hz sampling frequency
f2 = 800;
t2 = (0:50)/fs;
x2 = sin(2*pi*f2*t2);
figure(2)
subplot(2,1,1)
plot(t2,x2)
[H,w] = freqz(x2);
subplot(2,1,2)
plot(w,abs(H))
% Final signal
x = x1+x2;
figure(3)
subplot(2,1,1)
plot(t1,x)
[H,w] = freqz(x);
subplot(2,1,2)
plot(w,abs(H))


%
% Signal is filtered with TM4C123 using a circular buffer and Timer0 Interrupt to simulate an ADC
%

% LPF wc = 0.1Pi = 250Hz @ fc = 5000Hz
% Rectangular window method - 20dB att
% LPF coefficients: {0.0810332,  0.09003163,  0.09633978,  0.09958927, 0.09958927, 0.09633978,  0.09003163,  0.0810332}
y_lpf = [0.0, 0.07857465, 0.172048062, 0.220760137, 0.213857606, 0.199288517, 0.238870457, 0.35014078, 0.488984704, 0.510618091, 0.461058974, 0.446063876, 0.532006025, 0.683431804, 0.795274019, 0.789831877, 0.688490391, 0.591612637, 0.58526665, 0.66138649, 0.725480676, 0.684728324, 0.534674048, 0.364031672, 0.273125231, 0.281667709, 0.31148237, 0.260186315, 0.0974129587, -0.105766103, -0.241555989, -0.264238417, -0.231344968, -0.249007419, -0.372240931, -0.552744031, -0.682694733, -0.693906724, -0.620302022, -0.565719664, -0.606958151, -0.722067714, -0.810469508, -0.786227763, -0.657891214, -0.520774007, -0.468849421, -0.508033931, -0.551362455, -0.500518978]
figure(4)
subplot(2,1,1)
plot(y_lpf)
[H,w] = freqz(y_lpf);
subplot(2,1,2)
plot(w,abs(H))

% HPF wc = 0.2Pi = 500Hz @ fc = 5000Hz
% Rectangular window method - 20dB att
% HPF coefficients: {0.0810332,  0.09003163,  0.09633978,  0.09958927, 0.09958927, 0.09633978,  0.09003163,  0.0810332}
y_hpf = [0.0, 0.0713442862, 0.0135277882, 0.0748959705, -0.0771523565, 0.0500698984, -0.0265152864, 0.114929065, 0.0658899024, -0.00711327791, -0.0393548533, -0.00449721888, 0.0610344857, 0.091907993, 0.05463285, -0.0212982595, -0.0706908479, -0.0530925319, 0.00972875394, 0.0540981442, 0.0336071625, -0.0376984552, -0.098298654, -0.096221596, -0.0372371003, 0.0205721483, 0.0207724944, -0.0389752798, -0.104721904, -0.116281062, -0.0630917996, 0.00597629696, 0.027988255, -0.0156523492, -0.0819678828, -0.106346883, -0.062563248, 0.0128027499, 0.0542781875, 0.0281926431, -0.0361273661, -0.0736784041, -0.0441905037, 0.0303813294, 0.0861728713, 0.0766028166, 0.0155339874, -0.0356620848, -0.0251759179, 0.0411040969]
figure(5)
subplot(2,1,1)
plot(y_hpf)
[H,w] = freqz(y_hpf);
subplot(2,1,2)
plot(w,abs(H))

